Claro, vamos começar a criar um namespace do Event Hubs, um Event Hub dentro dele, enviar uma mensagem e, em seguida, consumi-la. Aqui estão os passos que você pode seguir usando o Azure CLI no Cloud Shell:


git clone https://github.com/able2cloud/cloud_public.git

cd cloud_public/event_hub


Login no Azure CLI: Se você ainda não fez login, faça-o com o comando:

az login
Siga as instruções na tela para concluir o login.

Crie um grupo de recursos: Vamos criar um grupo de recursos chamado "aula5" na região "us-east".

az group create --name aula5 --location eastus
Crie um namespace do Event Hubs: Vamos criar um namespace chamado "aula5namespace" no grupo de recursos "aula5". Este comando criará um namespace Standard.

az eventhubs namespace create --name aula5namespace --resource-group aula5 --sku Standard
Crie um Event Hub: Vamos criar um Event Hub chamado "aula5eventhub" no namespace "aula5namespace".

az eventhubs eventhub create --name aula5eventhub --namespace-name aula5namespace --resource-group aula5
Envie uma mensagem para o Event Hub: Primeiro, precisamos instalar a biblioteca do Azure Event Hubs para Python. Você pode fazer isso com o seguinte comando:

pip install azure-eventhub
Em seguida, você pode usar o seguinte script Python para enviar uma mensagem para o Event Hub:

pegue a string de conexão:
az eventhubs namespace authorization-rule keys list --resource-group <your-resource-group> --namespace-name <your-namespace-name> --name RootManageSharedAccessKey --query primaryConnectionString --output tsv



# Obtenha a string de conexão do namespace. Substitua com suas próprias informações.
connection_str = 'Endpoint=sb://aula5namespace.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=<YourPrimaryKey>;EntityPath=aula5eventhub'

python sender.py


Consuma a mensagem do Event Hub: Você pode usar o seguinte script Python para consumir a mensagem do Event Hub:

python consumer.py

# Substitua com suas próprias informações
connection_str = 'Endpoint=sb://aula5namespace.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=<YourPrimaryKey>;EntityPath=aula5eventhub'
consumer_group = '$Default'

